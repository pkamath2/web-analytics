<!doctype html>
<html>
    <head>
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
            <link rel="stylesheet" href="/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

            <script src="/js/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
            <script src="/js/popper.min.js" crossorigin="anonymous"></script>
            <script src="/js/d3.v4.min.js"></script>
    </head>
    <body>
        <div class="container">
            <p class="text-center"><h1>Tracker Analytics!</h1></p>
        </div>
        <div class="container">
            <div class="row">
                <div id="gender-pie" class="col-6" >
                    <svg width="400" height="400"></svg>
                </div>
                <div id="animals-vbar" class="col-6">
                    <svg width="500" height="500"></svg>
                </div>
            </div>
            <div class="row">
                <div id="os-hbar" class="col-6" >
                    <svg width="500" height="500"></svg>
                </div>
                <div id="browser-scatter" class="col-6">
                    <svg width="500" height="500"></svg>
                </div>
            </div>
        </div>
    </body>
    <script>
        var gender_color = d3.scaleSequential(d3.interpolateCool);
        var gender = d3.select("#gender-pie").select("svg");

        var gender_width = +gender.attr("width");
        var gender_height = +gender.attr("height");
        var gender_radius = Math.min(gender_width, gender_height) / 2;
        var gender_g = gender.append("g").attr("transform", "translate(" + gender_width / 2 + "," + gender_height / 2 + ")");
        var gender_arcs = d3.pie().value((d) => {return d.value});
        var path = d3.arc().outerRadius(gender_radius - 10).innerRadius(0);

        d3.json("/data/data.json",function(json) {
            gender_entries = d3.entries(json["GENDER"]);  
            var arc = gender_g.selectAll(".arc")
                            .data(gender_arcs(gender_entries))
                                .enter().append("g");
            arc.attr("class", "arc").append("path")
                                    .attr("d", path)
                                    .attr("fill", (d) => {return gender_color(d.index*.5)});
            arc.append("text").text((d)=>{return d.data.key;})
                                    .attr("transform", function(d) { return "translate(" + path.centroid(d) + ")"; })
                                    .attr("font-weight", "bold")
                                    .attr("dx","-1em")
                                        
        });



    </script>
</html>